<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Upscale HD - Enhance Image Quality</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; padding: 20px;
        }
        .container {
            max-width: 1000px; margin: 0 auto; background: white;
            border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; text-align: center; padding: 40px 20px;
        }
        header h1 { font-size: 2.5em; margin-bottom: 10px; }
        header p { font-size: 1.2em; opacity: 0.9; }
        main { padding: 40px; }
        
        .upload-area {
            border: 3px dashed #667eea; border-radius: 15px; padding: 60px 20px;
            text-align: center; transition: all 0.3s ease; background: #f8f9ff;
            cursor: pointer; margin-bottom: 30px;
        }
        .upload-area:hover, .upload-area.dragover { 
            background: #eef2ff; border-color: #764ba2; 
        }
        .upload-icon { font-size: 4em; margin-bottom: 20px; }
        .upload-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; border: none; padding: 12px 30px; border-radius: 25px;
            font-size: 1.1em; cursor: pointer; margin-top: 10px;
            transition: transform 0.2s ease;
        }
        .upload-btn:hover { transform: translateY(-2px); }
        
        .progress-area { 
            text-align: center; padding: 40px 20px; display: none; 
        }
        .progress-bar {
            width: 100%; max-width: 400px; height: 20px; background: #f0f0f0;
            border-radius: 10px; margin: 0 auto 20px; overflow: hidden;
        }
        .progress-fill {
            height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px; width: 0%; transition: width 0.3s ease;
        }
        
        .result-area { padding: 20px; display: none; }
        .comparison {
            display: flex; align-items: center; justify-content: space-between;
            gap: 30px; margin-bottom: 30px;
        }
        .image-box { 
            flex: 1; text-align: center; padding: 20px;
            background: #f8f9fa; border-radius: 15px;
        }
        .image-box h3 { margin-bottom: 15px; color: #333; }
        .image-box img { 
            max-width: 100%; max-height: 350px; border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .image-info { 
            margin-top: 15px; display: flex; justify-content: space-around;
            color: #666; font-size: 0.9em;
        }
        .arrow { font-size: 2em; color: #667eea; }
        
        .action-buttons { 
            display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;
        }
        .download-btn, .new-image-btn {
            padding: 12px 25px; border: none; border-radius: 25px;
            font-size: 1em; cursor: pointer; transition: transform 0.2s ease;
        }
        .download-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
        }
        .new-image-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .download-btn:hover, .new-image-btn:hover { transform: translateY(-2px); }
        
        .error-area { 
            text-align: center; padding: 40px 20px; display: none; 
        }
        .error-message {
            background: #ffebee; color: #c62828; padding: 20px;
            border-radius: 10px; margin-bottom: 20px;
            border-left: 4px solid #c62828;
        }
        
        footer {
            text-align: center; padding: 20px; background: #f8f9fa; 
            color: #666; border-top: 1px solid #eee;
        }
        
        @media (max-width: 768px) {
            .comparison { flex-direction: column; }
            .arrow { transform: rotate(90deg); margin: 20px 0; }
            header h1 { font-size: 2em; }
            main { padding: 20px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üñºÔ∏è Image Upscale HD</h1>
            <p>Enhance image quality up to 4x with AI technology</p>
        </header>

        <main>
            <div class="upload-area" id="uploadArea">
                <div class="upload-content">
                    <div class="upload-icon">üìÅ</div>
                    <h3>Drop image here or click to upload</h3>
                    <p>Supported formats: JPG, PNG, WebP (Max. 10MB)</p>
                    <input type="file" id="fileInput" accept="image/*" hidden>
                    <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                        Select Image
                    </button>
                </div>
            </div>

            <div class="progress-area" id="progressArea">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p id="progressText">Processing image... Please wait</p>
            </div>

            <div class="result-area" id="resultArea">
                <div class="comparison">
                    <div class="image-box">
                        <h3>üñºÔ∏è Original Image</h3>
                        <img id="originalImage" alt="Original">
                        <div class="image-info">
                            <span>Size: <span id="originalSize">-</span> KB</span>
                        </div>
                    </div>
                    
                    <div class="arrow">‚û°Ô∏è</div>
                    
                    <div class="image-box">
                        <h3>‚ú® HD Result</h3>
                        <img id="hdImage" alt="HD Result">
                        <div class="image-info">
                            <span>Size: <span id="hdSize">-</span> KB</span>
                            <span>Time: <span id="processTime">-</span>s</span>
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="download-btn" onclick="downloadHDImage()">
                        üíæ Download HD Image
                    </button>
                    <button class="new-image-btn" onclick="resetUpload()">
                        üÜï New Image
                    </button>
                </div>
            </div>

            <div class="error-area" id="errorArea">
                <div class="error-message" id="errorMessage"></div>
                <button class="new-image-btn" onclick="resetUpload()">
                    üîÑ Try Again
                </button>
            </div>
        </main>

        <footer>
            <p>Powered by AI Upscale Technology | Fast & Easy Image Enhancement</p>
        </footer>
    </div>

    <script>
        // Configuration - CHANGE THIS URL TO YOUR BACKEND
        const BACKEND_URL = 'https://imagetohd.vercel.app/';
        
        let hdImageData = null;
        let currentFileName = '';

        // Initialize event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');

            // Click to upload
            uploadArea.addEventListener('click', () => {
                fileInput.click();
            });

            // Drag and drop functionality
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFileSelect(files[0]);
                }
            });

            // File input change
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFileSelect(e.target.files[0]);
                }
            });
        });

        async function handleFileSelect(file) {
            // Validate file
            if (!file.type.startsWith('image/')) {
                showError('Please select a valid image file!');
                return;
            }

            if (file.size > 10 * 1024 * 1024) {
                showError('File size must be less than 10MB!');
                return;
            }

            currentFileName = file.name;
            await processImage(file);
        }

        async function processImage(file) {
            showProgress();
            
            try {
                const formData = new FormData();
                formData.append('image', file);

                // Simulate progress
                simulateProgress();
                
                const response = await fetch(BACKEND_URL, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    showResult(result);
                } else {
                    showError(result.message || 'Failed to process image');
                }

            } catch (error) {
                console.error('Error:', error);
                showError('Connection failed. Please check your internet connection and backend URL.');
            }
        }

        function simulateProgress() {
            const progressFill = document.getElementById('progressFill');
            let width = 0;
            const interval = setInterval(() => {
                if (width >= 90) {
                    clearInterval(interval);
                } else {
                    width += Math.random() * 10;
                    progressFill.style.width = Math.min(width, 90) + '%';
                }
            }, 200);
        }

        function showProgress() {
            document.getElementById('uploadArea').style.display = 'none';
            document.getElementById('resultArea').style.display = 'none';
            document.getElementById('errorArea').style.display = 'none';
            document.getElementById('progressArea').style.display = 'block';
            
            const progressFill = document.getElementById('progressFill');
            progressFill.style.width = '0%';
        }

        function showResult(result) {
            document.getElementById('progressArea').style.display = 'none';
            document.getElementById('resultArea').style.display = 'block';

            // Update images and info
            document.getElementById('originalImage').src = result.original.image;
            document.getElementById('hdImage').src = result.hd.image;
            document.getElementById('originalSize').textContent = result.original.size;
            document.getElementById('hdSize').textContent = result.hd.size;
            document.getElementById('processTime').textContent = result.processTime;

            // Store HD image data for download
            hdImageData = result.hd.image;
        }

        function showError(message) {
            document.getElementById('progressArea').style.display = 'none';
            document.getElementById('resultArea').style.display = 'none';
            document.getElementById('errorArea').style.display = 'block';
            document.getElementById('errorMessage').textContent = message;
        }

        function downloadHDImage() {
            if (!hdImageData) return;
            
            const link = document.createElement('a');
            link.href = hdImageData;
            const originalName = currentFileName.split('.')[0];
            link.download = `${originalName}-enhanced.jpg`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function resetUpload() {
            document.getElementById('fileInput').value = '';
            document.getElementById('resultArea').style.display = 'none';
            document.getElementById('errorArea').style.display = 'none';
            document.getElementById('progressArea').style.display = 'none';
            document.getElementById('uploadArea').style.display = 'block';
            
            // Reset stored data
            hdImageData = null;
            currentFileName = '';
        }
    </script>
</body>
</html>
